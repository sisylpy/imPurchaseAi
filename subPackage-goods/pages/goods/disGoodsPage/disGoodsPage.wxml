<wxs src="/utils/fn.wxs" module="tool" />

<view class="flex flex-column">
  <back-navbar style="height: {{navBarHeight}}rpx;" title="å•†å“è®¾ç½®" 
avatar="/images/back-gray.png" button-text="è®¾ç½®" bindnavbuttontap="toBack"></back-navbar>


  <view class="flex-row-between bg-white " style="width:{{windowWidth}}rpx;">
    <view class="flex-column p-20 font-md" style="width:{{windowWidth - 100}}rpx; ">
      <view class="flex-row p-10">
        <view class="half-row">
          <text class="text-secondary flex-fixed mr-10">å•†å“:</text>
          <text class="font-bold">{{goods.gbDgGoodsName}}</text>
        </view>
        <view class="half-row">
          <text class="text-secondary flex-fixed mr-10">è§„æ ¼:</text>
          <text class="">{{goods.gbDgGoodsStandardname}}</text>
        </view>
        
      </view>

      <view class=" flex-row-default p-10">
        <view class="flex-row half-row">
          <text class="text-secondary flex-fixed mr-10">å£å‘³:</text>
          <text class=" shrink_change" wx:if="{{goods.gbDgGoodsDetail !==  null && goods.gbDgGoodsDetail.length > 0}}">{{goods.gbDgGoodsDetail}}</text>
        </view>
        <view class="half-row">
          <text class="text-secondary flex-fixed mr-10">å•ä½é‡é‡:</text>
          <text class="pt-20 pb-20 shrink_change" wx:if="{{goods.gbDgGoodsStandardWeight !==  null && goods.gbDgGoodsStandardWeight.length > 0}}">{{goods.gbDgGoodsStandardWeight}}</text>
        </view>
      </view>

      <view class="flex-row p-10">
        <view class="half-row">
          <text class="text-secondary flex-fixed mr-10">å“ç‰Œ:</text>
          <text class="pt-20 pb-20 shrink_change" wx:if="{{goods.gbDgGoodsBrand !==  null && goods.gbDgGoodsBrand.length > 0}}">{{goods.gbDgGoodsBrand}}</text>
        </view>

        <view class="half-row">
          <text class="text-secondary flex-fixed mr-10">äº§åœ°:</text>
          <text class="pt-20 pb-20 shrink_change" wx:if="{{goods.gbDgGoodsPlace !==  null && goods.gbDgGoodsPlace.length > 0}}">{{goods.gbDgGoodsPlace}}</text>
        </view>
      </view>


      
      <view class=" flex-row-default p-10  mb-20">
        <view class="flex-row-default half-row">
          <text class="mr-10 text-secondary flex-fixed">å‡ºè´§æ¨¡å—:</text>
          <block wx:if="{{goods.gbDgGoodsType == 1}}">
            <text class="">é—¨åº—è‡ªé‡‡</text>
          </block>
          <block wx:if="{{goods.gbDgGoodsType == 2}}">
            <text class="">é›†é‡‡</text>
          </block>
          <block wx:if="{{goods.gbDgGoodsType == 21}}">
            <text class="">è‡ªåŠ¨è®¢è´§</text>
          </block>
          <block wx:if="{{goods.gbDgGoodsType == 3}}">
            <text class="">åº“æˆ¿</text>
          </block>

          <block wx:if="{{goods.gbDgGoodsType == 4}}">
            <text class="">ä¸­å¤®å¨æˆ¿</text>
          </block>
          <block wx:if="{{goods.gbDgGoodsType == 5}}">
            <text class="">é…é€</text>
          </block>
        </view>

        <view class="half-row flex-row-default" wx:if="{{goods.gbDistributerAppointSupplierEntity == null}}">
          <text class="text-secondary flex-fixed mr-10">å‡ºè´§éƒ¨é—¨:</text>
          <text class="shrink_change">{{goods.gbDepartmentEntity.gbDepartmentName}}</text>
        </view>
        <view class="half-row flex-row-default" wx:else="">
          <text class="text-secondary flex-fixed mr-10">ä¾›è´§å•†:</text>
          <text class="shrink_change">{{goods.gbDistributerAppointSupplierEntity.nxJrdhsSupplierName}}</text>
        </view>
      </view>

      <view class="flex-row p-10 border-bottom mb-20" wx:if="{{goods.gbDgGoodsType == 5}}">
        <view class="half-row">
          <text class="text-secondary flex-fixed mr-10">é…é€å•†:</text>
          <text class="pt-20 pb-20 shrink_change" wx:if="{{goods.nxDistributerEntity !== null}}">äº¬äº¬é€è´§</text>
          <text class="red" wx:else>æ— </text>
        </view>

        <view class="half-row">
          <text class="text-secondary flex-fixed mr-10">é…é€å•†å•†å“:</text>
          <text class="shrink_change pt-20 pb-20 " wx:if="{{goods.nxDistributerGoodsEntity !== null}}">{{goods.nxDistributerGoodsEntity.nxDgGoodsName}}</text>
          <text class="red" wx:else>æ— </text>
        </view>
      </view>

    </view>

    <view class="button-container-white" hover-class="hover" bindtap="openOperationBtn">
      <image src="/images/points.png" class="icon"></image>
    </view>
  </view>

  <view class="flex-column" id="mjltest0">
        <!-- <view class="bg-white p-20  border-bottom flex-column" wx:if="{{goods.gbDgIsSelfControl ==  1}}">
          <view class="flex-row-between pt-20 pb-20">
            <text class="text-secondary flex-fixed mr-10">æ˜¯å¦è‡ªåˆ¶</text>
            <switch checked="{{goods.gbDgIsSelfControl == 1 ? 'checked' : ''}}" bindchange="switchIsSelfControl" />
          </view>
          <block wx:if="{{goods.gbDgIsSelfControl == 1}}">
            <view class="flex-row p-10" style="width:{{windowWidth - 120}}rpx;">

              <view class="flex-row half-row">
                <text class="graymr-20">æˆæœ¬å•ä»·:</text>
                <view class="flex-row">
                  <text class="">{{goods.gbDgSelfPrice}}å…ƒ</text>
                  <text>/{{goods.gbDgGoodsStandardname}}</text>
                </view>

              </view>

            </view>
          </block>
        </view> -->
        <!-- <view class="bg-white p-20  border-bottom flex-column">
          <view class="flex-row-between pt-20 pb-20">
            <text class="text-secondary flex-fixed mr-10">æ˜¯å¦åŠ ç›Ÿ</text>
            <switch checked="{{goods.gbDgIsFranchisePrice == 1 ? 'checked' : ''}}" bindchange="switchIsFranchisePrice" />
          </view>
          <block wx:if="{{goods.gbDgIsFranchisePrice == 1}}">
            <view class="flex-row-between p-10">
              <view class="flex-row half-row">
                <text class="text-secondary flex-fixed mr-10">åŠ ç›Ÿä¸€çº§:</text>
                <text>{{goods.gbDgFranchisePriceOne}}å…ƒ/{{goods.gbDgGoodsStandardname}}</text>
              </view>
              <view class="flex-row half-row">
                <text class="text-secondary flex-fixed mr-10">æ—¶é—´:</text>
                <text>{{goods.gbDgFranchisePriceOneUpdate}}</text>
              </view>
            </view>

            <view class="flex-row-between p-10">
              <view class="flex-row half-row">
                <text class="text-secondary flex-fixed mr-10">åŠ ç›ŸäºŒçº§:</text>
                <text>{{goods.gbDgFranchisePriceTwo}}å…ƒ/{{goods.gbDgGoodsStandardname}}</text>
              </view>
              <view class="flex-row half-row">
                <text class="text-secondary flex-fixed mr-10">æ—¶é—´:</text>
                <text>{{goods.gbDgFranchisePriceTwoUpdate}}</text>
              </view>
            </view>
            <view class="flex-row-between p-10">
              <view class="flex-row half-row">
                <text class="text-secondary flex-fixed mr-10">åŠ ç›Ÿä¸‰çº§:</text>
                <text>{{goods.gbDgFranchisePriceThree}}å…ƒ/{{goods.gbDgGoodsStandardname}}</text>
              </view>
              <view class="flex-row half-row">
                <text class="text-secondary flex-fixed mr-10">æ—¶é—´:</text>
                <text>{{goods.gbDgFranchisePriceThreeUpdate}}</text>
              </view>
            </view>
          </block>
        </view> -->

        <!-- <view class="bg-white p-20  border-bottom flex-column" wx:if="{{disInfo.gbDistributerBusinessType !== 21 && disInfo.gbDistributerBusinessType !== 22}}">
          <view class="flex-row-between pt-20 pb-20">
            <text class="text-secondary flex-fixed mr-10">æ˜¯å¦æ§ä»·</text>
            <switch checked="{{goods.gbDgControlPrice == 1 ? 'checked' : ''}}" bindchange="switchControlPrice" />
          </view>

          <block wx:if="{{goods.gbDgControlPrice == 1}}">
            <view class="flex-row p-10" style="width:{{windowWidth - 120}}rpx;">
              <text class="graymr-20">ä»·æ ¼:</text>
              <view class="flex-row" style="width:{{windowWidth - 280}}rpx;">
                <text class="third-row">{{goods.gbDgGoodsPrice}}å…ƒ</text>

                <text class="third-row">{{goods.gbDgGoodsLowestPrice}}å…ƒ</text>

                <text class="third-row">{{goods.gbDgGoodsHighestPrice}}å…ƒ</text>

              </view>

            </view>
          </block>
        </view> -->

        <view class="bg-white p-20  border-bottom flex-column">
          <view class="flex-row-between pt-20 pb-20">
            <text class="text-secondary flex-fixed mr-10">ä¿é²œç®¡ç†</text>
            <switch checked="{{goods.gbDgControlFresh == 1 ? 'checked' : ''}}" bindchange="switchControlFresh" />
          </view>
          <block wx:if="{{goods.gbDgControlFresh == 1}}">
            <view class="flex-row p-10 small">
              <text class="graymr-20">æ—¶é—´è®¾ç½®:</text>
              <view style="width:{{windowWidth - 280}}rpx;" class="flex-row">
                <view class="flex-row half-row">
                  <text class="">{{goods.gbDgFreshWasteHour}}å°æ—¶åºŸå¼ƒ</text>
                </view>
              </view>
            </view>
          </block>
        </view>
        <view class="bg-white p-20  border-bottom flex-column">
          <text class="text-secondary small">å•†å“ä¸‹æ¶</text>
          <view class="flex-row-between pt-20 pb-20">
            <text class="text-secondary flex-fixed mr-10">åœæ­¢è®¢è´§</text>
            <switch checked="{{goods.gbDgPullOff == 1 ? 'checked' : ''}}" bindchange="switchChange" data-abc="pull" />
          </view>
        </view>

        <view class="bg-white p-20  flex-column border-bottom">
          <text class="text-secondary small">è®¢è´§å•ä½</text>
          <view class="flex-row-wrap pt-20 pb-20">
            <text class="standard">{{goods.gbDgGoodsStandardname}}</text>
            <view class="standard" wx:for="{{goods.gbDistributerStandardEntities}}" wx:for-item="standard" wx:key="gbDistributerStandardId" wx:for-index="standandIndex" bindtap="clickItem" data-itemstandard="{{standard}}" data-index="{{standandIndex}}" data-type="standard"><text class="mr-10">{{standard.gbDsStandardName}}</text>
              <text class="text-secondary" wx:if="{{standard.gbDsStandardScale !== null && standard.gbDsStandardScale > 0  }}">({{standard.gbDsStandardScale}}{{goods.gbDgGoodsStandardname}})</text>
            </view>

            <text class="standard" bindtap="addStandard" data-name="{{goods.gbGoodsEntity.gbGoodsName}}">+</text>
          </view>
        </view>

        <view class="bg-white p-20  flex-column border-bottom">
          <text class="text-secondary small">åˆ«å</text>
          <view class="flex-row-wrap pt-20 pb-20">
            <text class="standard" wx:for="{{goods.gbDistributerAliasEntities}}" wx:for-item="alias" wx:for-index="aliasIndex" wx:key="gbDistributerAliasId" bindtap="clickItem" data-itemalias="{{alias}}" data-type="alias" data-index="{{aliasIndex}}">{{alias.gbDaAliasName}}</text>
            <text class="standard" bindtap="addAlias" data-name="{{goods.gbGoodsEntity.gbGoodsName}}">+</text>
          </view>
        </view>

      </view>
</view>




<!-- mask catchtap="hideMask" -->
<view class='overlay {{showOperation ? "show" : "hide"}}' >
  <!-- + scrollViewTop -->
  <view class=" popup bg-white" wx:if="{{showChoice}}">
    <view class="p-20 mb-20 border-bottom" bindtap="edit">
      ç¼–è¾‘
    </view>
    <view class="p-20" bindtap="delete">åˆ é™¤</view>
  </view>


  <!--  showFresh -->

  <view class="bg-white popup" wx:elif="{{showFresh}}" >

    <view class="flex-column">
      <view class="flex-column center-content mainBack">
        <view class="p-20   five-weight  flex-row font-lg">
          {{goods.gbDgGoodsName}}({{goods.gbDgGoodsStandardname}})
        </view>
      </view>

      <view class="p-20 flex-row mb-30 mt-30">
        <text class="p-20"> åºŸå¼ƒæ—¶é—´:</text>
        <view style="position: relative; display: flex; align-items: center;">
          <input 
            class="inputPrice" 
            focus="{{showFresh}}" 
            type="digit" 
            value="{{goods.gbDgFreshWasteHour}}" 
            placeholder="è¯·è¾“å…¥å°æ—¶æ•°"
            placeholder-style="color: #999; font-size: 28rpx;"
            bindinput="getFresh" 
            data-type="gbDgFreshWasteHour" 
            style="width: {{windowWidth / 3}}rpx; border: 2rpx solid #e5e5e5; border-radius: 8rpx; padding: 10rpx; background-color: #f8f8f8;" 
          />
          <view 
            style="position: absolute; right: 10rpx; color: #1989fa; font-size: 24rpx; cursor: pointer;"
            catchtap="showFreshInputHint"
          >
            â“
          </view>
        </view>
        <text style="margin-left: 10rpx; color: #666; font-size: 28rpx;">ä¸ªå°æ—¶</text>
      </view>
      
      <!-- è¾“å…¥æç¤ºä¿¡æ¯ -->
      <view style="margin: -20rpx 20rpx 20rpx 20rpx; padding: 10rpx; background-color: #f0f8ff; border-radius: 8rpx; border-left: 4rpx solid #1989fa;">
        <text style="color: #1989fa; font-size: 24rpx;">ğŸ’¡ æç¤ºï¼šè¯·è¾“å…¥å•†å“ä¿é²œæ—¶é—´çš„å°æ—¶æ•°ï¼ˆä»…æ”¯æŒæ•´æ•°ï¼Œæœ€å¤§999å°æ—¶ï¼‰</text>
      </view>

      <view class=" p-20" style="width: {{windowWidth - 140}}rpx; ">
        <view class="flex-row" style="width: {{(windowWidth - 180) / 3 * 2}}rpx; margin-left: {{(windowWidth - 20)  / 3}}rpx; ">
          <view class="p-20" catchtap="cancleFresh">
            <text class="cancel-btn"> å–æ¶ˆ</text>
          </view>
          <view class="p-20" catchtap="{{goods.gbDgFreshWasteHour > 0 ? '_updateGoodsFresh' : ''}}" style="margin-left: 20rpx;">
            <text class="confirm-btn {{goods.gbDgFreshWasteHour > 0 ? 'is-active' : ''}}">ç¡®å®šåºŸå¼ƒè®¾ç½®</text>
          </view>
        </view>
      </view>
    </view>
  </view>
  <!-- ../showFresh -->


</view>
<!-- ./mask -->



<view class='overlay {{showOperationBtn ? "show" : "hide"}}' style="height:{{maskHeight > windowHeight ? maskHeight : windowHeight}}rpx;" catchtap="hideMaskBtn">

  <view class="flex-column nnn bg-white">
    <!-- <view class="p-30 flex-row border-bottom" catchtap="toLiziMarket">
      <image src="/images/location.png" class="icon mr-20"></image>
      <text class="">æŸ¥çœ‹å¸‚åœºä¾›åº”</text>
    </view> -->
    
    <view class="p-30 flex-row border-bottom" catchtap="toOpenDetail">
      <image src="/images/edit.png" class="icon mr-20"></image>
      <text class="">ä¿®æ”¹å•†å“</text>
    </view>

    <view class="p-30 flex-row" catchtap="deleteDisGoods">
      <image src="/images/ashbin.png" class="icon mr-20"></image>
      <text class="">åˆ é™¤å•†å“</text>
    </view>

     <view style="height: 20rpx;"></view>
  </view>

</view>



<addStandard show="{{showAdd}}" bindgetFocus="getFocus" bindconfirm="confirmStandard" bindcancle="cancle" goods="{{goods}}" standardScale="{{standardScale}}" depGoodsName="{{depGoodsName}}" standardName="{{standardName}}" windowHeight="{{windowHeight}}" edit="{{editStandard}}" itemStandard="{{itemStandard}}"  />


<addAlias show="{{showAddAlias}}" bindgetFocus="getFocus" bindconfirm="confirmAlias" bindcancle="cancle" depGoodsName="{{depGoodsName}}" windowHeight="{{windowHeight}}"  standardName="{{standardName}}" edit="{{editAlias}}" standardName="{{standardName}}" itemAlias="{{itemAlias}}" />