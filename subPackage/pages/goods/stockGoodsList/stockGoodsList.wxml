<wxs src="../../../../utils/fn.wxs" module="tool" />



<view class="flex flex-column ">
  <back-navbar style="height: {{navBarHeight}}rpx;" title="{{disGoods.gbDgGoodsName}} {{value}}{{disGoods.gbDgGoodsStandardname}}" avatar="/images/back-gray.png" button-text="设置" bindnavbuttontap="toBack"></back-navbar>

  <!--  top -->


<!--  top -->
<view class=" flex-row-between pl-20 pr-20  bg-white border-bottom ">
    <view class="flex-row">
      <view class="p-20" bindtap="toDatePage">
        <image src="/images/calender.png" class="icon"></image>
      </view>
      <view class="flex-column">
        <view class="flex-row" wx:if="{{startDate == stopDate}}">
          <view class=" font-xs"> {{tool.transferDateString(startDate)}}</view>
        </view>
        <view class="flex-row" wx:else>
          <view class=" font-xs" wx:if="{{startDate}}"> {{tool.transferDateString(startDate)}}</view>
          <text class="p-10">-</text>
          <view class=" font-xs" wx:if="{{stopDate}}">{{tool.transferDateString(stopDate)}}</view>
        </view>
      </view>
    </view>
    <view class="flex-row p-20" bindtap="toMyDate">
      <image src="{{filterShow ? '/images/filter.png' : '/images/filter-3-fill.png'}}" class="icon mr-20"></image>
    </view>
  </view>



  <view class="p-10 ">


    <view class=" {{stockArr.length == 0  ? 'show' : 'hide'}}" style="height: {{windowHeight - 260 - navBarHeight}}rpx; text-align:center;">
      <view class="normal  empty_view">
        <view class="flex-column-center">
          <image class="empty_image" src="../../../images/cart-Empty.png"></image>
          <text class="big">暂时无订购商品</text>
        </view>
      </view>
    </view>

    <view class="flex-column p-10">

      <view class="flex-column font-sl radius-10 border bg-white mb-30" wx:for="{{stockArr}}">

        <view class="flex-column">
          <view class="flex-row  p-20 border-bottom">

            <view class="flex-row half-row font-lg font-bold">
              <image src="/images/department.png" mode="aspectFill" class="icon mr-10" />
              <text>{{item.gbDepartmentOrdersEntity.orderDepartment.gbDepartmentName}}</text>
            </view>
            <view class="half-row flex-row-reverse  font-lg font-bold">
              <text></text>
              <text class="">{{tool.getAttrDateString(item.gbDgsDate)}}</text>
            </view>

          </view>
          <view class="flex-row p-20 border-bottom">
            <view class="flex-row half-row ">
              <text class="mr-10">库存:</text>
              <text>{{item.gbDgsRestWeight}}{{disGoods.gbDgGoodsStandardname}}</text>
            </view>
            <view class="flex-row half-row ">
              <text class="mr-10">库存金额:</text>
              <text>{{item.gbDgsRestSubtotal}}元</text>
            </view>
           
          </view>

          <view class="flex-row  p-20 border-bottom">

            <view class="flex-row half-row ">
              <text class="mr-10">进货:</text>
              <text>{{item.gbDgsWeight}}{{disGoods.gbDgGoodsStandardname}}</text>
            </view>
            <view class="flex-row half-row ">
              <text class="mr-10">单价:</text>
              <text>{{item.gbDgsPrice}}元/{{disGoods.gbDgGoodsStandardname}}</text>
            </view>

          </view>
          <view class="flex-row  p-20 border-bottom">

            <view class="flex-row half-row ">
              <text class="mr-10">进货金额:</text>
              <text>{{item.gbDgsSubtotal}}元</text>
            </view>
            <view class="flex-row half-row ">
              <text class="mr-10">制作:</text>
              <text>{{item.gbDgsProduceWeight}}{{disGoods.gbDgGoodsStandardname}}</text>
            </view>

          </view>

          <view class="flex-row  p-20 border-bottom">

            <view class="flex-row half-row ">
              <text class="mr-10">损耗:</text>
              <text>{{item.gbDgsLossWeight}}{{disGoods.gbDgGoodsStandardname}}</text>
            </view>
            <view class="flex-row half-row ">
              <text class="mr-10">废弃:</text>
              <text>{{item.gbDgsWasteWeight}}{{disGoods.gbDgGoodsStandardname}}</text>
            </view>

          </view>

          <view class="flex-row  p-20 border-bottom">

           
            <view class="flex-row half-row" wx:if="{{item.nxDistributerEntity !== null}}">
              <text class="mr-10">配送商:</text>
              <text class="">京京送货</text>
            </view>
            <view class="flex-row half-row" wx:elif="{{item.nxJrdhSupplierEntity !== null}}">
              <text class="mr-10">订货商:</text>
              <text class="">{{item.nxJrdhSupplierEntity.nxJrdhsSupplierName}}</text>
            </view>

            <view class="flex-row half-row" wx:else>
              <text class="mr-10">自采:</text>
              <text class="">{{disInfo.purDepartmentList[0].gbDepartmentName}}</text>
            </view>
            <view class="flex-row half-row ">
              <text class="mr-10">废弃:</text>
              <text>{{item.gbDgsWasteWeight}}{{disGoods.gbDgGoodsStandardname}}</text>
            </view>

          </view>



          <block wx:if="{{item.gbDgsWasteFullTime !== null  && item.gbDgsWasteFullTime !== ''}}">
            <view class="flex-row p-20 border-bottom">
              <view class="flex-row half-row">
                <text class="mr-10">废弃剩余: </text>
                <text class="{{tool.getRestTime(item.gbDgsWasteFullTime, nowTime) < 0 ? 'text-danger' :''}}">{{tool.getRestTime(item.gbDgsWasteFullTime, nowTime)}}小时</text>
              </view>
              <view class="flex-row half-row">
                <text class="mr-10">废弃时间: </text>
                <text>{{tool.getAttrFullTime(item.gbDgsWasteFullTime)}}</text>
              </view>
            </view>
          </block>

          <view class="flex-row  p-20 border-bottom">

            <view class="flex-row-between  ">
              <view class="flex-row" style="width: {{windowWidth - 180}}rpx;">
                <text class="mr-10 flex-fixed">新鲜度:</text>
              <image wx:for="{{item.gbDgsStars}}" src="/images/starGreen.png" mode="aspectFill" class="icon-sm mr-10" />
              </view>

              <text class="p-10 mainColor" bind:tap="toStarDetail" data-="">查看</text>
             


              
            </view>

          </view>
        </view>


      </view>

    </view>


  </view>


</view>





<stockGoods show="{{showStock}}" bindconfirm="confirmStock" bindupdateStars="updateStars" item="{{item}}" disGoods="{{disGoods}}" bindcancle="cancle" windowHeight="{{windowHeight}}" windowWidth="{{windowWidth}}" consultItem="{{item}}" nowTime="{{nowTime}}" src="{{src}}" reason="{{reason}}" canWaste="{{canWaste}}" canSure="{{canSure}}" showType="{{showType}}" resultTime="{{resultTime}}" url="{{url}}" />


<stockStar show="{{showStar}}" bindconfirm="confirmStar" bindupdateStars="updateStars" binddelAttem="delAttem" item="{{item}}" disGoods="{{disGoods}}" bindcancle="cancle" windowHeight="{{windowHeight}}" windowWidth="{{windowWidth}}" consultItem="{{item}}" nowTime="{{nowTime}}" src="{{src}}" reason="{{reason}}" canWaste="{{canWaste}}" canSure="{{canSure}}" showType="{{showType}}" resultTime="{{resultTime}}" url="{{url}}" />