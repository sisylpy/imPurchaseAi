<import src='../../../../template/resGoods/resGoods.wxml' />
<import src="../../../../template/resGroup/resGroup" />
<wxs src="../../../../utils/fn.wxs" module="tool" />

<view class="flex flex-column">

  <back-navbar style="height: {{navBarHeight}}rpx;" title="{{depInfo.gbDepartmentName}}" avatar="/images/back-gray.png" button-text="设置" bindnavbuttontap="toBack"></back-navbar>

  <view class='navbar border-bottom pt-20 pb-20' >
    <block wx:for="{{tabs}}" wx:key="*this">
      <view id="{{index}}" class="navbar-item {{tab1Index==index?'bar-item-on':''}}" data-index='{{index}}' bindtap='onTab1Click'>
        <view class='navbar-title'>{{item}}</view>
      </view>
    </block>
    <view class="navbar-slider" style="left: {{sliderLeft}}px; width:{{windowWidth / 6}}rpx; transform: translateX({{sliderOffset}}px); -webkit-transform: translateX({{sliderOffset}}px);">
    </view>
  </view>

  <swiper bindchange="switchTab" style="height: {{ windowHeight - 300  }}rpx;  " bindanimationfinish="animationfinish" current="{{itemIndex}}" data-index='{{itemIndex}}'>
    <!-- 常购配送 -->
    <swiper-item>
      <!-- empty -->
      <view class=" {{depGoodsArr.length == 0  ? 'show' : 'hide'}}" style="height: {{windowHeight - 360}}rpx;margin-top: 160rpx;">
          <view class="flex-column center-content">
            <image class="empty_image" src="../../images/cart-Empty.png"></image>
            <text class="big">暂时无订货商品</text>
          </view>
        
      </view>
      <!-- ./empty -->

      <view class="flex-row-default" wx:if="{{depGoodsArr.length > 0}}">

        <view class="left">
          <scroll-view scroll-y="true" style="height: {{windowHeight - 200 - statusBarHeight}}rpx; " scroll-top="{{scrollTopLeft}}" scroll-with-animation="true">
            <view class="dep_left_item {{selectedSub == index ? 'left-active' : ''}}" wx:for="{{depGoodsArr}}" wx:key="gbDistributerFatherGoodsId" wx:for-item="grand" bindtap="leftMenuClick" data-index="{{index}}" style="position: relative; float: left; ">
              <text class="" style="position: absolute; left: 80rpx; top: 10rpx; background-color: rgb(23, 102, 248); color: #fff; border-radius: 50%; width: 40rpx; height: 40rpx;text-align: center; " wx:if="{{grand.newOrderCount > 0}}">{{grand.newOrderCount}}</text>
              <view class="font-xs" style="width: 90rpx; text-align: center; white-space: normal;">
                <text>{{grand.gbDfgFatherGoodsName}}</text>
              </view>
            </view>
          </scroll-view>
          <!-- <view class="" style="height: 200rpx; background-color: yellow;">
              </view> -->
        </view>

        <view class="bg-white  pb-20 pt-20" style="padding-left: 20rpx;">
          <scroll-view scroll-y="true" scroll-with-animation="true" bindscroll="scrollTo" scroll-into-view="{{positionId}}" style="width: {{windowWidth - 150}}rpx; height: {{windowHeight - 200- navBarHeight}}rpx; ">
            <view class="dep_right_item" wx:for="{{depGoodsArr}}" wx:key="gbDistributerFatherGoodsId" wx:for-item="grand" wx:for-index="grandIndex" id="position{{grandIndex}}">
              <view class="flex-column" wx:for="{{grand.fatherGoodsEntities}}"  
               wx:for-item="father" wx:for-index="fatherIndex">
                <view class="flex-row-default  border-bottom  p-10" wx:for-item="goods" wx:key="gbDepartmentDisGoodsId" wx:for-index="depGoodsIndex"  
                wx:for="{{father.gbDepartmentDisGoodsEntities}}">
                  <image bindtap="showDialogBtn" data-item="{{goods.gbDistributerGoodsEntity}}" src="{{url + goods.gbDistributerGoodsEntity.gbDgNxFatherImg}}" mode="aspectFill" class="url_item margin-right" />

                  <view class="flex-row" catch:tap="{{goods.gbDepartmentOrdersEntity == null ? 'applyGoodsDep' : 'toEditApplyDep'}}" data-order="{{goods.gbDepartmentOrdersEntity}}" data-disgoods="{{goods.gbDistributerGoodsEntity}}" data-grandindex="{{grandIndex}}"  data-fatherindex="{{fatherIndex}}" data-index="{{depGoodsIndex}}" data-depgoods="{{goods}}" hover-class="hover">
                    <view class="flex-column " style="width: {{windowWidth - 400}}rpx; ">
                      <view class="middle five-weight nnnn" style="width: {{windowWidth - 400}}rpx; ">
                        <text>{{goods.gbDistributerGoodsEntity.gbDgGoodsName}}</text>
                        <block wx:if="{{goods.gbDistributerGoodsEntity.nxDistributerAliasEntities.length > 0}}">
                          <text wx:for="{{goods.gbDistributerGoodsEntity.gbDistributerAliasEntities}}" wx:for-item="alias">@{{alias.gbDaAliasName}}</text>
                        </block>
                      </view>

                      <view class="flex-row small">
                        <view class="flex-row">
                          <text class="gray">规格:</text>
                          <block wx:if="{{goods.gbDistributerGoodsEntity.gbDgGoodsStandardWeight.length > 0}}">
                            <view class="" wx:if="{{goods.gbDistributerGoodsEntity.gbDgGoodsStandardname !== '斤'}}">
                              {{goods.gbDistributerGoodsEntity.gbDgGoodsStandardWeight}}/{{goods.gbDistributerGoodsEntity.gbDgGoodsStandardname}}
                            </view>
                          </block>

                          <block wx:else>
                            <text class="">{{goods.gbDistributerGoodsEntity.gbDgGoodsStandardname}}</text>
                          </block>
                        </view>
                      </view>

                      <view class="flex-row-between" style=" width: {{windowWidth - 280}}rpx;">
                        <text>京京送货</text>
                  
                      </view>
                      <view class="flex-row font-xs">
                        <view class="flex-row half-row" wx:if="{{goods.gbDistributerGoodsEntity.gbDgGoodsDetail !== null && goods.gbDistributerGoodsEntity.gbDgGoodsDetail.length > 0}}">
                          <text class="gray">说明:</text>
                          <text>{{goods.gbDistributerGoodsEntity.gbDgGoodsDetail}}</text>
                        </view>
                        <view class="flex-row" wx:if="{{goods.gbDistributerGoodsEntity.gbDgGoodsPlace !== null && goods.gbDistributerGoodsEntity.gbDgGoodsPlace.length > 0}}">
                          <text>产地:</text>
                          <text class="">{{goods.gbDistributerGoodsEntity.gbDgGoodsPlace}}</text>
                        </view>
                      </view>

                    </view>

                  </view>

                  <!-- ../ -->
                </view>
              </view>
            </view>

            <view class="flex-column font-xs center-content ">
              <view class="flex-row">  
                <view style="line-height: 200rpx;">没有数据啦!</view>
              </view>
            </view>
          </scroll-view>

        </view>
        <view>
        </view>

      </view>

      <!-- </scroll-view> -->
    </swiper-item>



    <!-- 2， 用户 -->
    <swiper-item class="bg-white">
      <view class="flex-column">
        <scroll-view scroll-y style="height:{{windowHeight - navBarHeight -260}}rpx;  ">

          <template is="resGroup" data="{{userArr:userArr,windowWidth:windowWidth, url: url}}"></template>

        </scroll-view>

        <view class="center-content">
          <view class="flex-row  applyBtn" style="width:{{windowWidth  - 80 }}rpx; " bindtap="toOpenOrder" >
            <view style="width:{{windowWidth  - 180 }}rpx; text-align:center; ">
              <image src="../../../../images/adduser.png" class="icon margin-right" style="margin-left: 100rpx;"></image>
              <text>邀请门店员工注册</text>
            </view>
          </view>

        </view>
      </view>
    </swiper-item>
  </swiper>

</view>

<!--  操作  -->
<view class='overlay {{showOperationUser ? "show" : "hide"}}' catchtouchmove='ture' catchtap="hideMask" catchtouchmove='ture' catchtap="hideUserMask">
  <view class="flex-column nnn bg-white">

    <view class="flex-row  p-30 operation_row " bindtap="delUser">
      <image src="../../../../images/del.png" class="icon mr-10"></image>
      <text class=" margin-right">删除用户</text>
    </view>
    <view style="height: 20rpx;"></view>
  </view>
</view>