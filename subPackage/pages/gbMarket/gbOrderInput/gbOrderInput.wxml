<wxs src="../../../../utils/fn.wxs" module="tool" />
<import src='../../../../template/carGb/carGb.wxml' />

<view class="">
    <view class="top_img_fixed flex-row" style="width: 100%; height: 110rpx; line-height: 110rpx; padding-top: {{statusBarHeight}}rpx;">
      <image src="../../../../images/back-2.png" class="back_icon" bindtap="toBack" ></image>
      <text>录入单价</text>
    </view>
    <image src="../../../../images/top.png" style="width: 100%; height: {{statusBarHeight + 110}}rpx;"></image>
  </view>


<view class="flex-column" >

	<view class="section" >
		<view class="maodian flex-row" style="margin-top: {{statusBarHeight}}rpx;">
			<view class="flex-row" wx:for="{{batch.gbDPGEntities}}" wx:for-index="firIndex">
				<text id="NAV{{firIndex}}" style="width:{{windowWidth / (batch.gbDPGEntities.length)}}rpx;" wx:key="firIndex">
				</text>
			</view>
		</view>

		<view class="section_body" style="top:{{statusBarHeight + 110}}rpx">
			<scroll-view class="tui-city-scroll-y p-20" scroll-y="true"
				scroll-into-view="NAV{{focusGoodsIndex}}{{focusOrderIndex}}" scroll-with-animation="true">
				<view class=" p-20  input_item {{index == focusGoodsIndex ? 'is-active' : ''}}"
					wx:for="{{batch.gbDPGEntities}}" wx:key="gbDistributerPurchaseGoodsId" wx:for-index="index" id="NAV{{index}}">
					<view class="flex-column p-20" style=" font-size: 50rpx; width: {{windowWidth - 80}}rpx;">
						<view class="flex-row-wrap">
							<text class="mr-10">{{index + 1}}.</text>
							<text>{{item.gbDistributerGoodsEntity.gbDgGoodsName}}</text>
              <text class="small gray"
					wx:if="{{item.gbDistributerGoodsEntity.gbDgGoodsDetail.length > 0 && item.gbDistributerGoodsEntity.gbDgGoodsDetail !== 'null'}}">{{item.gbDistributerGoodsEntity.gbDgGoodsDetail}}</text>
							<block
								wx:if="{{item.gbDpgStandard !== item.gbDistributerGoodsEntity.gbDgGoodsStandardname && item.gbDpgBuyScale !== '-1'}}">
								<text class="margin-right"> ({{item.gbDpgStandard}})</text>
							</block>
						</view>
						<view class="flex-row font-lg" bindtap="changeFocusIndex" data-index="{{index}}">
							<text class="mr-10 empty">{{index + 1}}.</text>
							<text class="mr-10">今日单价:</text>
							<block
								wx:if="{{item.gbDpgStandard !== item.gbDistributerGoodsEntity.gbDgGoodsStandardname && item.gbDpgBuyScale !== '-1'}}">
								<view class="inputTotal flex-row mr-10"
									style="margin-left:50rpx; width:{{(windowWidth - 240)/2}}rpx; ">
									<text class="input_number"
										wx:if="{{item.gbDpgBuyScalePrice !== null && item.gbDpgBuyScalePrice !== '0.0'}}">{{item.gbDpgBuyScalePrice}}</text>
									<view class='analog_cursor {{index == focusGoodsIndex ? "is-active" : "" }}'>
									</view>
								</view>
								<text>元/{{item.gbDistributerGoodsEntity.gbDgGoodsStandardname}}</text>
							</block>
							<block wx:else>
								<view class="inputTotal flex-row mr-10"
									style="margin-left:50rpx; width:{{(windowWidth - 240)/2}}rpx; ">
									<text class="input_number"
										wx:if="{{item.gbDpgBuyPrice !== null && item.gbDpgBuyPrice !== '0.0'}}">{{item.gbDpgBuyPrice}}</text>
									<view class='analog_cursor {{index == focusGoodsIndex ? "is-active" : "" }}'>
									</view>
								</view>
								<text>元/{{item.gbDistributerGoodsEntity.gbDgGoodsStandardname}}</text>
							</block>
						</view>

						<view class="flex-cloumn with-tb-padding border-bottom font-md" wx:for-item="orders"
							wx:for="{{item.gbDepartmentOrdersEntities}}" wx:for-index="orderIndex">
							<view class="flex-row font-lg">
								<text class="mr-10 empty">{{index + 1}}.</text>
								<block wx:if="{{orders.gbDepartmentEntity.fatherGbDepartmentEntity !== null}}">
									<text>{{orders.gbDepartmentEntity.fatherGbDepartmentEntity.gbDepartmentName}}.</text>
									<text class="mr-10">{{orders.gbDepartmentEntity.gbDepartmentName}}</text>
								</block>
								<block wx:else>
									<text class="mr-10">{{orders.gbDepartmentEntity.gbDepartmentName}}</text>
								</block>
								<text>{{orders.gbDoQuantity}}{{orders.gbDoStandard}}</text>
								<!-- <block
									wx:if="{{orders.gbDoDsStandardScale !== null && orders.gbDoDsStandardScale.length > 0 && orders.gbDoDsStandardScale !== '-1'}}">
									<text
										class="small">({{orders.gbDoDsStandardScale}}{{item.gbDistributerGoodsEntity.gbDgGoodsStandardname}}/{{orders.gbDoStandard}})</text>
								</block> -->
							</view>

							<view class="flex-row font-lg">
								<text class="mr-10 empty">{{index + 1}}.</text>
								<view class="flex-row" style="width:{{(windowWidth - 140)}}rpx;;">
									<view class="half-row">
										<text class="mr-10">数量:</text>
										<block
											wx:if="{{orders.gbDoDsStandardScale !== null && orders.gbDoDsStandardScale > 0 && orders.gbDoDsStandardScale !== '-1'}}">
											<text class="" 	wx:if="{{orders.gbDoScaleWeight !== null && orders.gbDoScaleWeight !== '0.0'}}">{{orders.gbDoScaleWeight}}{{orders.gbDoStandard}}</text>
										</block>
										<block wx:else>
											<text
												wx:if="{{orders.gbDoWeight !== null && orders.gbDoWeight !== '0.0'}}">{{orders.gbDoWeight}}{{item.gbDistributerGoodsEntity.gbDgGoodsStandardname}}</text>
										</block>
									</view>
									<view class="half-row">
										<text class="mr-10">小计:</text>
										<text class=""
											wx:if="{{orders.gbDoSubtotal !== null && orders.gbDoSubtotal !== '0.0'}}">{{orders.gbDoSubtotal}}元</text>
									</view>
								</view>
							</view>
						</view>

						<view class="flex-row-reverse font-md">
							<text class="">{{item.gbDpgBuySubtotal !== null && item.gbDpgBuySubtotal !== '0.0' ? item.gbDpgBuySubtotal
								: ' '}}元</text>
							<text class="mr-10">总小计:</text>
						</view>
					</view>

					<!-- ./single bumen -->
				</view>
				<view class="bottom_place" style="height:{{!lastInput ? windowHeight : 160}}rpx;"></view>
			</scroll-view>
		</view>
	</view>
</view>



<view class="overlay {{isTishi ? 'show' : 'hide'}}">

	<view class="bg-white"
		style="margin-top:{{(windowHeight - 440)/2 }}rpx;margin-left: 50rpx; width:{{windowWidth - 100}}rpx;">
		<view class="mb-30  flex-column-center">

			<view class="tishiView"
				style="width:{{windowWidth/5}}rpx; height:{{windowWidth/5}}rpx; margin-top:-{{windowWidth/10 + 10}}rpx; z-index: 9999;border-radius: 50%;">
				<image src="../../../../images/aixin.png" class="tishi_icon"
					style="width:{{windowWidth / 5 - 80}}rpx; height:{{windowWidth/5 - 80}}rpx;  border-radius: 50%; margin-top:40rpx; margin-left: 40rpx;">
				</image>
			</view>

			<view class="flex-column-center sentence">
				<text class="small p-20">完成后请准备好订单商品</text>
				<text class="font-lg ">采购员将会看到您回复的订单</text>
			</view>

      <view class="flex-row-between p-30 " style="width: {{windowWidth - 180}}rpx;">
					<text class="explain">付款方式</text>
					<view class="rightPart">
						<radio-group class="radio-group" bindchange="radioChange" >
						<label class="radio mr-30"><radio value="0" checked="{{batch.gbDpbPayType == 0}}" />现金</label>
						<label class="radio"><radio value="1" checked="{{batch.gbDpbPayType == 1}}" />记账</label>
						</radio-group>
					</view>
				</view>


			<view class="p-20 flex-row-between" style="margin-top: 30rpx;">
				<view class="bg-light  p-20" bindtap="cancelCostBatch"
					style="width:{{windowWidth / 3}}rpx; text-align: center; margin-right: 40rpx;" hover-class="hover">
					再等等
				</view>

				<view class="{{batch.gbDpbPayType !== null ? 'bg-success' : 'bg-light'}} p-20" bindtap="sendSucess"
					style="width:{{windowWidth / 3}}rpx; text-align: center;" hover-class="hover">
					备货完成
				</view>
			</view>
		</view>

	</view>

	
</view>


<view class='customize_key_board  flex-row {{lastInput ? "hidden" : ""}}'>

	<view class="input_number_part">
		<view class="num_container flex-column-center "
			style="width:{{numContainerWidth}}rpx; height:{{numContainerWidth}}rpx; line-height:{{numContainerWidth}}rpx;">
			<view class="num" hover-class="numHover"
				style="width:{{numWidth}}rpx; height:{{numWidth}}rpx; line-height:{{numWidth}}rpx;" bindtap="inputValue"
				data-value="7"> 7</view>
		</view>
		<view class="num_container flex-column-center"
			style="width:{{numContainerWidth}}rpx; height:{{numContainerWidth}}rpx; line-height:{{numContainerWidth}}rpx;">
			<view class="num" hover-class="numHover"
				style="width:{{numWidth}}rpx; height:{{numWidth}}rpx; line-height:{{numWidth}}rpx;" bindtap="inputValue"
				data-value="8"> 8</view>
		</view>
		<view class="num_container flex-column-center"
			style="width:{{numContainerWidth}}rpx; height:{{numContainerWidth}}rpx; line-height:{{numContainerWidth}}rpx;">
			<view class="num" hover-class="numHover"
				style="width:{{numWidth}}rpx; height:{{numWidth}}rpx; line-height:{{numWidth}}rpx;" bindtap="inputValue"
				data-value="9"> 9</view>
		</view>
		<view class="num_container flex-column-center"
			style="width:{{numContainerWidth}}rpx; height:{{numContainerWidth}}rpx; line-height:{{numContainerWidth}}rpx;">
			<view class="num" hover-class="numHover"
				style="width:{{numWidth}}rpx; height:{{numWidth}}rpx; line-height:{{numWidth}}rpx;" bindtap="inputValue"
				data-value="4"> 4</view>
		</view>
		<view class="num_container flex-column-center"
			style="width:{{numContainerWidth}}rpx; height:{{numContainerWidth}}rpx; line-height:{{numContainerWidth}}rpx;">
			<view class="num" hover-class="numHover"
				style="width:{{numWidth}}rpx; height:{{numWidth}}rpx; line-height:{{numWidth}}rpx;" bindtap="inputValue"
				data-value="5"> 5</view>
		</view>
		<view class="num_container flex-column-center"
			style="width:{{numContainerWidth}}rpx; height:{{numContainerWidth}}rpx; line-height:{{numContainerWidth}}rpx;">

			<view class="num" hover-class="numHover"
				style="width:{{numWidth}}rpx; height:{{numWidth}}rpx; line-height:{{numWidth}}rpx;" bindtap="inputValue"
				data-value="6"> 6</view>
		</view>
		<view class="num_container flex-column-center"
			style="width:{{numContainerWidth}}rpx; height:{{numContainerWidth}}rpx; line-height:{{numContainerWidth}}rpx;">
			<view class="num" hover-class="numHover"
				style="width:{{numWidth}}rpx; height:{{numWidth}}rpx; line-height:{{numWidth}}rpx;" bindtap="inputValue"
				data-value="1"> 1</view>
		</view>
		<view class="num_container flex-column-center"
			style="width:{{numContainerWidth}}rpx; height:{{numContainerWidth}}rpx; line-height:{{numContainerWidth}}rpx;">

			<view class="num" hover-class="numHover"
				style="width:{{numWidth}}rpx; height:{{numWidth}}rpx; line-height:{{numWidth}}rpx;" bindtap="inputValue"
				data-value="2"> 2</view>
		</view>
		<view class="num_container flex-column-center"
			style="width:{{numContainerWidth}}rpx; height:{{numContainerWidth}}rpx; line-height:{{numContainerWidth}}rpx;">

			<view class="num" hover-class="numHover"
				style="width:{{numWidth}}rpx; height:{{numWidth}}rpx; line-height:{{numWidth}}rpx;" bindtap="inputValue"
				data-value="3"> 3</view>
		</view>
		<view class="num_container flex-column-center"
			style="width:{{numContainerWidth}}rpx; height:{{numContainerWidth}}rpx; line-height:{{numContainerWidth}}rpx;">
			<view class="num" hover-class="numHover"
				style="width:{{numWidth}}rpx; height:{{numWidth}}rpx; line-height:{{numWidth}}rpx;" bindtap="inputValue"
				data-value="del"> X</view>

		</view>
		<view class="num_container flex-column-center"
			style="width:{{numContainerWidth}}rpx; height:{{numContainerWidth}}rpx; line-height:{{numContainerWidth}}rpx;">
			<view class="num" hover-class="numHover"
				style="width:{{numWidth}}rpx; height:{{numWidth}}rpx; line-height:{{numWidth}}rpx;" bindtap="inputValue"
				data-value="0"> 0</view>
		</view>
		<view class="num_container flex-column-center"
			style="width:{{numContainerWidth}}rpx; height:{{numContainerWidth}}rpx; line-height:{{numContainerWidth}}rpx;">
			<view class="num" hover-class="numHover"
				style="width:{{numWidth}}rpx; height:{{numWidth}}rpx; line-height:{{numWidth}}rpx;" bindtap="inputValue"
				data-value=".">.</view>
		</view>
	</view>

	<view class="flex-column">
		<view class="double_num_container flex-column-center"
			style="width:{{numContainerWidth}}rpx; height:{{numContainerWidth }}rpx; line-height:{{numContainerWidth}}rpx;">
			<view class="double_num " style="width:{{numWidth}}rpx; height:{{numWidth}}rpx; line-height:{{numWidth}}rpx;"
				bindtap="inputValue" data-value="close" hover-class="numHover">关闭</view>
		</view>


		<view class="double_num_container flex-column-center"
			style="width:{{numContainerWidth}}rpx; height:{{numContainerWidth * 3 + 40 }}rpx; line-height:{{numContainerWidth * 3 + 40 }}rpx;">

			<view class="double_num1 save_double_btn"
				style="width:{{numWidth}}rpx; height:{{numWidth * 3 + 70}}rpx; line-height:{{numWidth * 3 + 70}}rpx;"
				bindtap="inputValue" data-value="next" hover-class="numHover">保存</view>
		</view>

	</view>


</view>


<template is="car" data='{{lastInput:lastInput,payTotal:payTotal,goodsCount:goodsCount}}'></template>

