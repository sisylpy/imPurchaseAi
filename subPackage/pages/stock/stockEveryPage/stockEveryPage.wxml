<wxs src="../../../../utils/fn.wxs" module="tool" />


<view class="flex flex-column">

  <back-navbar title="{{fatherNeme}}" style="height: {{navBarHeight}}rpx;" avatar="/images/back-gray.png" button-text="设置" bindnavbuttontap="toBack"></back-navbar>


  <block wx:if="{{searchDepIds == -1}}">

    <view class="flex-column ">

      <view class="flex-column font-lg  p-20">
        <text class="mr-10">{{dateString}}</text>
        <text class="">{{total}}元</text>
      </view>
      <view class="flex-row-between  font-md bg-white  border-bottom p-30" wx:for="{{arr}}" wx:for-index="goodsIndex" wx:key="gbDistributerGoodsId" bindtap="toStockList" data-id="{{item.gbDistributerGoodsId}}" data-name="{{item.gbDgGoodsName}}" data-detail="{{item.gbDgGoodsDetail}}" hover-class="hover" data-item="{{item}}">

        <view class="flex-row-default">
          <text class="mr-10">{{goodsIndex + 1}}.</text>

          <view class="flex-row-wrap ">
            <text class="mr-10">{{item.gbDgGoodsName}}</text>
        
            <block wx:if="{{item.gbDgGoodsStandardWeight !== 'null' && item.gbDgGoodsStandardWeight.length > 0}}">
              <text wx:if="{{item.gbDgGoodsStandardname !== '斤'}}">({{item.gbDgGoodsStandardWeight}}/{{item.gbDgGoodsStandardname}})</text>
            </block>
            <block wx:else>
              <text wx:if="{{item.gbDgGoodsStandardname !== '斤'}}">({{item.gbDgGoodsStandardname}})</text>
            </block>
            <text class="text-secondary font-sm">{{item.gbDgGoodsDetail !== null ? item.gbDgGoodsDetail : '' }}</text>
          </view>

        </view>

        <view class="flex-row flex-fixed">
          <view class="flex-column">
            <view class="mr-20">{{item.goodsStockTotalString}}元</view>
            <view class=" font-xs text-danger" wx:if="{{item.goodsWasteTotalString > 0}}">(已过期{{item.goodsWasteTotalString}}元)</view>
          </view>
          <text class="">({{item.goodsWeightTotalString}}{{item.gbDgGoodsStandardname}})</text>
          <image src="/images/arrow-right-3.png" mode="aspectFill" class="icon ml-10" />
        </view>

      </view>
    </view>

  </block>


  <block wx:else="">

    <block wx:if="{{resultDepList.length == 1}}">

      <view class=" flex-row border-bottom">
        <scroll-view scroll-x="true" show-scrollbar="false" enhanced="true" class="nav_dep" scroll-with-animation="{{true}}" scroll-left="{{leftWidthDep}}" style="width: {{windowWidth - 40 }}rpx; ">
          <text id="dep_fixed" data-id="-1" class="dep_item  {{itemIndexDep == 0 ? 'is-active' : ''}}" data-index='0' data-total="{{whichTotalDep}}" bindtap="onTab1ClickDepTypeOfFenxi" data-item="all">{{resultDepList[0].gbDepartmentName}}({{resultDepList[0].depStockSubtotalString}}元)</text>
        </scroll-view>

      </view>

      <scroll-view scroll-y style="height:{{ windowHeight - 420 - statusBarHeight}}rpx;">

        <view class="flex-column ">

          <view class="flex-column   mr-10  p-20">
            <text>{{days}}</text>
            <text class="">{{total}}元</text>
          </view>
          <view class="flex-row-default  font-xl bg-white  border-bottom p-20" wx:for="{{arr}}" wx:for-index="goodsIndex" wx:key="gbDistributerGoodsId" bindtap="toStockList" data-id="{{item.gbDistributerGoodsId}}" data-name="{{item.gbDgGoodsName}}" data-detail="{{item.gbDgGoodsDetail}}" hover-class="hover" data-item="{{item}}">
            <view class="flex-row">
              <text class="mr-10">{{goodsIndex + 1}}.</text>
              <view class="flex-row-between" style="width: {{windowWidth - 80}}rpx;">
                <view class="flex-row-wrap ">
                  <text class="mr-10">{{item.gbDgGoodsName}}</text>
                  <text class="">{{item.gbDgGoodsDetail !== null ? item.gbDgGoodsDetail : '' }}</text>
                  <block wx:if="{{item.gbDgGoodsStandardWeight !== 'null' && item.gbDgGoodsStandardWeight.length > 0}}">
                    <text wx:if="{{item.gbDgGoodsStandardname !== '斤'}}">({{item.gbDgGoodsStandardWeight}}/{{item.gbDgGoodsStandardname}})</text>
                  </block>
                  <block wx:else>
                    <text wx:if="{{item.gbDgGoodsStandardname !== '斤'}}">({{item.gbDgGoodsStandardname}})</text>
                  </block>
                </view>
                <view class="flex-row">
                  <view class="flex-row margin-right">
                    <text class=" small gray margin-right">{{item.goodsWeightTotalString}}{{item.gbDgGoodsStandardname}}</text>
                    <text class=" font-xs red margin-right" wx:if="{{item.goodsWasteTotalString > 0}}">(已过期{{item.goodsWasteTotalString}}元)</text>
                    <text class="">{{item.goodsStockTotalString}}元</text>
                  </view>
                </view>

              </view>
            </view>

          </view>
        </view>


      </scroll-view>

    </block>

    <block wx:else="">

      <view class=" flex-row border-bottom">
        <scroll-view scroll-x="true" show-scrollbar="false" enhanced="true" class="nav_dep" scroll-with-animation="{{true}}" scroll-left="{{leftWidthDep}}" style="width: {{windowWidth - 40 }}rpx; ">
          <text id="dep_fixed" data-id="-1" class="dep_item  {{itemIndexDep == 0 ? 'is-active' : ''}}" data-index='0' data-total="{{whichTotalDep}}" bindtap="onTab1ClickDepTypeOfFenxi" data-item="all">{{resultDepList.length}}个门店({{total}}元)</text>

          <text id="dep_{{dep.gbDepartmentId}}" data-id="{{dep.gbDepartmentId}}" class="dep_item {{itemIndexDep == depIndex + 1 ? 'is-active' : ''}}" data-index='{{depIndex + 1}}' bindtap="onTab1ClickDepTypeOfFenxi" data-item="{{dep}}" wx:for="{{resultDepList}}" wx:for-item="dep"  wx:key="gbDepartmentId" wx:for-index="depIndex" data-name="{{dep.gbDepartmentName}}">{{dep.gbDepartmentName}}({{dep.depStockSubtotalString}}元)</text>

        </scroll-view>

      </view>

      <swiper duration="300" bindanimationfinish="animationfinishDepType" current="{{itemIndexDep}}" data-index='{{itemIndexDep}}' style="height: {{windowHeight - 420}}rpx;" wx:if="{{resultDepList.length > 1}}">

        <swiper-item style="height: 100%;">
          <scroll-view scroll-y style="height:{{ windowHeight - 420 - statusBarHeight}}rpx;">

            <view class="flex-column ">

              <view class="flex-column   mr-10  p-20">
                <text>{{days}}</text>
                <text class="">{{total}}元</text>
              </view>
              <view class="flex-row-default   bg-white  border-bottom p-20" wx:for="{{arr}}" wx:for-index="goodsIndex" wx:key="gbDistributerGoodsId" bindtap="toStockList" data-id="{{item.gbDistributerGoodsId}}" data-name="{{item.gbDgGoodsName}}" data-detail="{{item.gbDgGoodsDetail}}" hover-class="hover" data-item="{{item}}">
                <view class="flex-row">
                  <text class="mr-10">{{goodsIndex + 1}}.</text>
                  <view class="flex-row-between" style="width: {{windowWidth - 80}}rpx;">
                    <view class="flex-row-wrap ">
                      <text class="mr-10">{{item.gbDgGoodsName}}</text>
                      <text class="">{{item.gbDgGoodsDetail !== null ? item.gbDgGoodsDetail : '' }}</text>
                      <block wx:if="{{item.gbDgGoodsStandardWeight !== 'null' && item.gbDgGoodsStandardWeight.length > 0}}">
                        <text wx:if="{{item.gbDgGoodsStandardname !== '斤'}}">({{item.gbDgGoodsStandardWeight}}/{{item.gbDgGoodsStandardname}})</text>
                      </block>
                      <block wx:else>
                        <text wx:if="{{item.gbDgGoodsStandardname !== '斤'}}">({{item.gbDgGoodsStandardname}})</text>
                      </block>
                    </view>
                    <view class="flex-row">
                      <view class="flex-row margin-right">
                        <text class=" small gray margin-right">{{item.goodsWeightTotalString}}{{item.gbDgGoodsStandardname}}</text>
                        <text class=" font-xs red margin-right" wx:if="{{item.goodsWasteTotalString > 0}}">(已过期{{item.goodsWasteTotalString}}元)</text>
                        <text class="">{{item.goodsStockTotalString}}元</text>
                      </view>
                    </view>

                  </view>
                </view>

              </view>
            </view>


          </scroll-view>
        </swiper-item>

        <!-- total -->
        <swiper-item style="height: 100%;" wx:for="{{resultDepList}}" wx:for-item="dep" wx:key="gbDepartmentId">
          <scroll-view scroll-y style="height:{{ windowHeight - 420 - statusBarHeight}}rpx;">
            <view class="flex-column ">
              <view class="flex-column   mr-10  p-20">
                <text>{{days}}</text>
                <text class="">{{total}}元</text>
              </view>
              <view class="flex-row-default   bg-white  border-bottom p-20" wx:for="{{arr}}" wx:for-index="goodsIndex" wx:key="gbDistributerGoodsId" bindtap="toStockList" data-id="{{item.gbDistributerGoodsId}}" data-name="{{item.gbDgGoodsName}}" data-detail="{{item.gbDgGoodsDetail}}" hover-class="hover" data-item="{{item}}">
                <view class="flex-row">
                  <text class="mr-10">{{goodsIndex + 1}}.</text>
                  <view class="flex-row-between" style="width: {{windowWidth - 80}}rpx;">
                    <view class="flex-row-wrap ">
                      <text class="mr-10">{{item.gbDgGoodsName}}</text>
                      <text class="">{{item.gbDgGoodsDetail !== null ? item.gbDgGoodsDetail : '' }}</text>
                      <block wx:if="{{item.gbDgGoodsStandardWeight !== 'null' && item.gbDgGoodsStandardWeight.length > 0}}">
                        <text wx:if="{{item.gbDgGoodsStandardname !== '斤'}}">({{item.gbDgGoodsStandardWeight}}/{{item.gbDgGoodsStandardname}})</text>
                      </block>
                      <block wx:else>
                        <text wx:if="{{item.gbDgGoodsStandardname !== '斤'}}">({{item.gbDgGoodsStandardname}})</text>
                      </block>
                    </view>
                    <view class="flex-row">
                      <view class="flex-row margin-right">
                        <text class=" small gray margin-right">{{item.goodsWeightTotalString}}{{item.gbDgGoodsStandardname}}</text>
                        <text class=" font-xs red margin-right" wx:if="{{item.goodsWasteTotalString > 0}}">(已过期{{item.goodsWasteTotalString}}元)</text>
                        <text class="">{{item.goodsStockTotalString}}元</text>
                      </view>
                    </view>

                  </view>
                </view>

              </view>
            </view>

          </scroll-view>
        </swiper-item>

      </swiper>


    </block>



  </block>

</view>