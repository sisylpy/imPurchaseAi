<wxs src="../../../../utils/fn.wxs" module="tool" />


<view class="flex flex-column flex-1">


  <back-navbar style="height: {{navBarHeight}}rpx;" title="{{nxGoodsName}}" avatar="/images/back-gray.png" button-text="设置" bindnavbuttontap="toBack"></back-navbar>
 
  <view class=" {{distributerArr.length == 0  ? 'show' : 'hide'}}"
    style="height: {{windowHeight - 360}}rpx; text-align:center;">
    <view class="normal  empty_View">
      <view class="flex-column-center">
        <image class="empty_image" src="../../../../images/file-common.png"></image>
        <text class="big">暂时分派配送客户</text>
        <text class="small darkgray with-tb-padding">这里显示等待配送的客户</text>
      </view>
    </view>
  </view>

  <view class="flex-row-between">
    <view class="with-padding half-row halfButton {{showDitu ? 'is-active' : ''}}" bindtap="toDitu">附近</view>
    <view class="with-padding half-row halfButton {{showLiebiao ? 'is-active' : ''}}" bindtap="toLiebiao">列表</view>
  </view>

  <view wx:if="{{distributerArr.length> 0 && showDitu}}">
    <map id="myMap" class="map" latitude="{{latitude}}" longitude="{{longitude}}" markers="{{markers}}"
      scale="{{scale}}"></map>

    <view class="flex-row-between border-bottom p-20 border-bottom bg-white font-md" wx:for="{{distributerArr}}" wx:for-item="res"
      wx:for-index="resIndex" value='{{res.nxDistributerId}}' >
      
      <view class="flex-column">
      <view class="flex-row">
      <text class="mr-10 text-secondary">商户:</text>
      <text class=""> {{res.nxDistributerName}}</text>
      </view>
      <view class="flex-row-default ">
      <text class="mr-10 text-secondary flex-fixed">地址:</text>
      <text class="">{{res.nxDistributerAddress}}</text>
      </view>
      <view class="flex-row-between"  style="width: {{windowWidth - 80}}rpx;">
        <view class="flex-row half-row">
          <text class="mr-10 text-secondary">距离:</text>
          <text>{{tool.getGongli(res.distance,1)}}公里</text>
        </view> 
        <view class="flex-row half-row">
          <text class="mr-10 text-secondary">出货:</text>
          <text class="mainColor font-bold">{{res.purGoodsTotalString}}{{disGoods.gbDgGoodsStandardname}}</text>
        </view>
        

      </view>

      <view class="flex-row-between">
          <view class="flex-row mt-10 ">
            <!-- <text class="mr-10 text-secondary">手机:</text> -->
            <image src="/images/call-2.png" mode="aspectFill" class="icon mr-20"/>
            <text class="font-bold text-main" bind:tap="toPhone" data-phone="{{res.nxDistributerPhone}}" >{{res.nxDistributerPhone}}</text>
          </view>
        </view>
    </view>
    <view bind:tap=""  bindtap="toNxdistributer"  data-item="{{res}}" data-id="{{res.nxDistributerId}}" data-name="{{res.nxDistributerName}}">
    <image src="/images/arrow-right-3.png" mode="aspectFill" class="icon"/>
    </view>
    </view>
  </view>


</view>