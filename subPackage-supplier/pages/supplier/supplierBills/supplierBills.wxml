<wxs src="../../../../utils/fn.wxs" module="tool" />


<view class="flex flex-column">
<back-navbar title="{{supplierName}}" avatar="/images/back-gray.png" button-text="设置" bindnavbuttontap="toBack"></back-navbar>

<!--  top -->
<view class=" flex-row-between border-bottom bg-white"  style="margin-top: {{navBarHeight}}rpx;">
  <view class="flex-row">
    <view class="p-20" bindtap="toDatePage">
      <image src="../../../../images/calender.png" class="icon"></image>
    </view>
    <view class="flex-column">
      <view class="flex-row" wx:if="{{startDate == stopDate}}">
        <view class=" small" wx:if="{{startDate}}"> {{tool.transferDateString(startDate)}}</view>
      </view>
      <view class="flex-row" wx:else>
        <view class=" small" wx:if="{{startDate}}"> {{tool.transferDateString(startDate)}}</view>
        <text class="p-10">-</text>
        <view class=" small" wx:if="{{stopDate}}">{{tool.transferDateString(stopDate)}}</view>
      </view>
    </view>
  </view>
  
  <view class="flex-row p-20" bindtap="toFilter">
    <!-- <image src="{{searchDepIds !== -1 ? '../../../../images/filter.png' : '../../../../images/filter-3-fill.png'}}" class="icon mr-20"></image> -->
  </view>
</view>


<view class="flex-column">

  <!-- 供货商统计信息卡片 -->
  <view class="supplier-stats-card">
    <view class="stats-item">
      <view class="stats-icon supplier-orders-icon">
        <image src="/images/calender.png" class="stats-icon-image"></image>
      </view>
      <view class="stats-content">
        <text class="stats-label">订单</text>
        <text class="stats-value">{{billArr.length}}个</text>
      </view>
    </view>
    
    <view class="stats-divider"></view>
    
    <view class="stats-item">
      <view class="stats-icon supplier-total-icon">
        <image src="/images/money.png" class="stats-icon-image"></image>
      </view>
      <view class="stats-content">
        <text class="stats-label">订货总额</text>
        <text class="stats-value">{{value}}元</text>
      </view>
    </view>
  </view>

  <view class="flex-column {{billArr.length == 0  ? 'show' : 'hide'}}" style="height: {{windowHeight /3}}rpx;">
    <view class="flex-column center-content" style="margin-top: 200rpx;" >
      <image class="empty_image" src="/images/xiuxi.png"></image>
      <text class="p-30">暂无微信好友完成订单</text>
    </view>
  </view>

  <!-- 订单列表容器 -->
  <view class="supplier-bills-container" wx:if="{{billArr.length > 0}}">
    
    <view class="supplier-bill-item" wx:for="{{billArr}}" wx:for-item="item" wx:key="gbDistributerPurchaseBatchId" hover-class="supplier-bill-hover" bindtap="openBatchDetail" data-id="{{item.gbDistributerPurchaseBatchId}}" data-value="{{item.gbDpbSubtotal}}" data-item="{{item}}">
      
      <!-- 订单类型标签 -->
      <view class="bill-type-section">
        <view class="bill-type-tag">
          <text class="bill-type-text tag-return" wx:if="{{item.gbDpbPurchaseType == 9}}">退货单</text>
          <text class="bill-type-text tag-auto" wx:elif="{{item.gbDpbPurchaseType == 21}}">自动订货</text>
          <text class="bill-type-text tag-purchase" wx:else="">采购员订货</text>
        </view>
        <view class="bill-arrow-section">
          <image src="../../../../images/arrow-right-3.png" class="bill-arrow-icon"></image>
        </view>
      </view>

      <!-- 订单主要信息 -->
      <view class="bill-main-info">
        <view class="bill-date-section">
          <text class="bill-date-text">{{item.gbDpbDate}}</text>
          <text class="bill-weekday-text">{{item.gbDpbPurchaseWeek}}</text>
        </view>
        <view class="bill-right-section">
          <view class="bill-amount-section">
            <text class="bill-amount-value">¥{{item.gbDpbSubtotal}}</text>
            <text class="bill-amount-label">订货金额</text>
          </view>
          <view class="bill-status-section">
            <view class="status-badge status-pending" wx:if="{{item.gbDpbStatus == 3}}">待结账</view>
            <view class="status-badge status-settled" wx:elif="{{item.gbDpbStatus == 4}}">已结账</view>
          </view>
        </view>
      </view>

    </view>

   
      <view class="text-secondary center-content font-sm" style="height: 200rpx;">没有数据了!</view>
  </view>

</view>

</view>
